<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DTL">
<meta name="dcterms.date" content="2026-02-15">

<title>CvH Proteomics — Differential Expression Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="CvH_DEP_files/libs/clipboard/clipboard.min.js"></script>
<script src="CvH_DEP_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="CvH_DEP_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="CvH_DEP_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="CvH_DEP_files/libs/quarto-html/popper.min.js"></script>
<script src="CvH_DEP_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="CvH_DEP_files/libs/quarto-html/anchor.min.js"></script>
<link href="CvH_DEP_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CvH_DEP_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CvH_DEP_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="CvH_DEP_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="CvH_DEP_files/libs/bootstrap/bootstrap-82a8e0681529fff444bbc39736ff6b3a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-differential-expression-in-proteomics" id="toc-introduction-differential-expression-in-proteomics" class="nav-link active" data-scroll-target="#introduction-differential-expression-in-proteomics">1 — Introduction: Differential Expression in Proteomics</a></li>
  <li><a href="#study-contrasts-biological-questions" id="toc-study-contrasts-biological-questions" class="nav-link" data-scroll-target="#study-contrasts-biological-questions">2 — Study Contrasts: Biological Questions</a></li>
  <li><a href="#statistical-model-three-layers-of-robustness" id="toc-statistical-model-three-layers-of-robustness" class="nav-link" data-scroll-target="#statistical-model-three-layers-of-robustness">3 — Statistical Model: Three Layers of Robustness</a>
  <ul class="collapse">
  <li><a href="#arrayweights-sample-level-quality-weighting" id="toc-arrayweights-sample-level-quality-weighting" class="nav-link" data-scroll-target="#arrayweights-sample-level-quality-weighting">3.1 — arrayWeights: Sample-Level Quality Weighting</a></li>
  <li><a href="#duplicatecorrelation-paired-design-modeling" id="toc-duplicatecorrelation-paired-design-modeling" class="nav-link" data-scroll-target="#duplicatecorrelation-paired-design-modeling">3.2 — duplicateCorrelation: Paired-Design Modeling</a></li>
  <li><a href="#ebayesrobust-true-outlier-robust-hyperparameters" id="toc-ebayesrobust-true-outlier-robust-hyperparameters" class="nav-link" data-scroll-target="#ebayesrobust-true-outlier-robust-hyperparameters">3.3 — eBayes(robust = TRUE): Outlier-Robust Hyperparameters</a></li>
  <li><a href="#how-the-three-methods-complement-each-other" id="toc-how-the-three-methods-complement-each-other" class="nav-link" data-scroll-target="#how-the-three-methods-complement-each-other">3.4 — How the Three Methods Complement Each Other</a></li>
  </ul></li>
  <li><a href="#results-training_cr" id="toc-results-training_cr" class="nav-link" data-scroll-target="#results-training_cr">4 — Results: Training_CR</a></li>
  <li><a href="#results-cancer_vs_healthy" id="toc-results-cancer_vs_healthy" class="nav-link" data-scroll-target="#results-cancer_vs_healthy">5 — Results: Cancer_vs_Healthy</a></li>
  <li><a href="#results-supplement_interaction" id="toc-results-supplement_interaction" class="nav-link" data-scroll-target="#results-supplement_interaction">6 — Results: Supplement_Interaction</a></li>
  <li><a href="#multi-criteria-significance" id="toc-multi-criteria-significance" class="nav-link" data-scroll-target="#multi-criteria-significance">7 — Multi-Criteria Significance</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">8 — Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session Info</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CvH Proteomics — Differential Expression Analysis</h1>
<p class="subtitle lead">limma with arrayWeights, duplicateCorrelation, and Robust eBayes</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DTL </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 15, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(readr, dplyr, tidyr, knitr, ggplot2, patchwork, ggrepel, here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data_dir   <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">"04_DEP"</span>, <span class="st">"c_data"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>report_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">"04_DEP"</span>, <span class="st">"b_reports"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="introduction-differential-expression-in-proteomics" class="level1">
<h1>1 — Introduction: Differential Expression in Proteomics</h1>
<p>Differential expression analysis in proteomics (DEP) identifies proteins whose abundance differs systematically between experimental conditions. Unlike simple fold-change filtering, formal statistical testing accounts for measurement variability across biological replicates and controls the rate of false discoveries when thousands of proteins are tested simultaneously. The goal is to move beyond descriptive abundance profiles toward rigorous inference about which proteins respond to the conditions under study.</p>
<p>In the context of label-free quantitative proteomics, each protein’s measured intensity is subject to multiple sources of variation: biological variability between subjects, technical variability from sample preparation and LC-MS acquisition, and the stochastic nature of data-dependent or data-independent acquisition. A sound statistical framework must model these sources explicitly rather than treating the data as if each protein were measured in isolation.</p>
<p>The limma framework (Ritchie et al., 2015) has become the dominant approach for small-sample proteomics experiments because it stabilizes variance estimates through empirical Bayes shrinkage. Rather than estimating a variance for each protein independently—an unreliable procedure when only a handful of replicates are available—limma borrows information across all proteins to produce a moderated variance estimate. This shrinkage pulls extreme per-protein variances toward a common prior, yielding more stable test statistics and substantially greater power to detect true differences (Smyth, 2004).</p>
<p>An alternative framework, DEqMS (Zhu et al., 2020), extends limma by modeling the relationship between variance and peptide count. In proteomics, proteins identified by more peptides tend to have more precise quantification, and DEqMS leverages this relationship to produce count-specific variance priors. However, DEqMS requires a complete data matrix—it cannot accommodate missing values because the peptide-count-to-variance relationship breaks down when some samples lack measurements entirely. This distinction drives the pipeline’s automatic method selection.</p>
<p>The present analysis uses the non-imputed data pathway, selected on the basis of the sensitivity analysis conducted in the preceding analysis step. Because the cycloess-normalized data retains its natural missingness pattern, the pipeline selects limma as the appropriate engine. This choice preserves the biological reality that low-abundance proteins in certain conditions are genuinely below the detection limit, rather than filling in synthetic values that could bias fold-change estimates.</p>
<p>The limma pipeline applied here incorporates three layers of robustness beyond the standard empirical Bayes framework: sample-level quality weighting via arrayWeights, within-subject correlation modeling via duplicateCorrelation, and outlier-robust hyperparameter estimation via eBayes(robust = TRUE). These three mechanisms operate at different levels—sample, design, and protein—and together produce a model that is well-suited to the challenges of this dataset.</p>
<p>This document presents the results of the differential expression analysis. All computations were performed by the companion R script (<code>CvH_DEP.R</code>); this narrative reads the output files and presents them with scientific context and interpretation.</p>
<p>The sections that follow describe the biological questions encoded as contrasts, the statistical model and its justification, the results for each contrast, and the multi-criteria significance framework used to interpret findings from both well-powered and underpowered comparisons.</p>
</section>
<section id="study-contrasts-biological-questions" class="level1">
<h1>2 — Study Contrasts: Biological Questions</h1>
<p>The study examines skeletal muscle proteome remodeling in cancer survivors undergoing resistance training, with a secondary question about whether creatine supplementation modifies that response. Cancer survivors (CR) who had completed primary treatment were randomized to receive either creatine (CRE) or placebo (PLA) during a 12-week progressive resistance training program. Vastus lateralis biopsies were collected at baseline (T1) and post-training (T2). A separate group of healthy age-matched controls (PPS) provided a single baseline biopsy for comparison.</p>
<p>Three contrasts capture the study’s central hypotheses. Each is defined as a linear combination of group means from the five-level factor (CRE_T1, CRE_T2, PLA_T1, PLA_T2, H_T1) used in the design matrix.</p>
<p><strong>Training_CR</strong> = (CRE_T2 + PLA_T2)/2 – (CRE_T1 + PLA_T1)/2. This contrast asks whether 12 weeks of resistance training changes the skeletal muscle proteome in cancer survivors. By averaging across supplement groups, it isolates the main effect of training, pooling both CRE and PLA arms to maximize statistical power. Any protein whose abundance shifts from T1 to T2—regardless of whether the subject received creatine or placebo—will be detected by this contrast.</p>
<p><strong>Cancer_vs_Healthy</strong> = (CRE_T1 + PLA_T1)/2 – H_T1. This contrast compares the baseline muscle proteome of cancer survivors with that of healthy controls. Only baseline timepoints are used, ensuring that the comparison reflects the pre-training state. Because this contrast captures fundamental biological differences between cancer survivors and healthy individuals—differences shaped by the disease itself, prior treatments (chemotherapy, radiation), and associated deconditioning—it is expected to yield the strongest signal among the three comparisons.</p>
<p><strong>Supplement_Interaction</strong> = (CRE_T2 – CRE_T1) – (PLA_T2 – PLA_T1). This interaction contrast tests whether creatine supplementation modifies the training response differently than placebo. It compares the within-subject change in the CRE arm against the within-subject change in the PLA arm. A significant result would indicate that the proteome-level training adaptation depends on supplement assignment. This is the most demanding contrast statistically, as it requires detecting a difference of differences with approximately 8 subjects per supplement group.</p>
<p>These three contrasts were chosen to address the study’s primary aims comprehensively. The Training_CR contrast addresses the rehabilitation question (does exercise help?), the Cancer_vs_Healthy contrast quantifies the deficit (how different are cancer survivors?), and the Supplement_Interaction contrast evaluates the nutritional intervention (does creatine add benefit?). Together they span the study’s biological scope from descriptive comparison to mechanistic interaction.</p>
<p>The contrast definitions are encoded in the design matrix and passed to limma’s contrasts.fit function, which re-parameterizes the fitted coefficients to test each linear combination. Importantly, all three contrasts are tested from the same model fit, ensuring consistent variance estimation across comparisons.</p>
</section>
<section id="statistical-model-three-layers-of-robustness" class="level1">
<h1>3 — Statistical Model: Three Layers of Robustness</h1>
<p>The differential expression model used here extends the standard limma pipeline with three complementary robustness mechanisms. Each addresses a distinct source of heterogeneity: arrayWeights handles sample-level quality variation, duplicateCorrelation handles within-subject correlation from the paired design, and eBayes(robust = TRUE) handles protein-level variance outliers. Understanding why each is necessary requires considering the specific challenges of this dataset.</p>
<section id="arrayweights-sample-level-quality-weighting" class="level2">
<h2 class="anchored" data-anchor-id="arrayweights-sample-level-quality-weighting">3.1 — arrayWeights: Sample-Level Quality Weighting</h2>
<p>Not all samples contribute equally to the analysis. Variation in biopsy quality, protein extraction efficiency, and LC-MS performance means that some samples are inherently noisier than others. The traditional approach is to identify and remove outlier samples, but this discards potentially informative data and requires arbitrary threshold decisions.</p>
<p>arrayWeights (Ritchie et al., 2006) provides a principled alternative. It estimates a quality weight for each sample by fitting a heterogeneous error model: samples with higher residual variance receive lower weights, while cleaner samples receive higher weights. This weighting is incorporated into all subsequent model fitting, so noisy samples contribute less to coefficient estimates without being removed entirely. The approach is analogous to weighted least squares in classical regression, but the weights are estimated from the data rather than specified a priori.</p>
<p>Liu et al.&nbsp;(2015) demonstrated that sample-level weighting substantially improves power in RNA-seq analyses, and the same principle applies to proteomics data where sample quality variation is often more pronounced due to the complexity of the LC-MS workflow. In the present dataset, array weights ranged from well below 1.0 (downweighted samples) to above 2.0 (upweighted samples), confirming meaningful quality heterogeneity across the cohort.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>aw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"array_weights.csv"</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Array weights: min = %.3f, median = %.3f, max = %.3f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">min</span>(aw<span class="sc">$</span>array_weight), <span class="fu">median</span>(aw<span class="sc">$</span>array_weight), <span class="fu">max</span>(aw<span class="sc">$</span>array_weight)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Array weights: min = 0.107, median = 1.165, max = 3.344</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aw, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(sample_id, array_weight), <span class="at">y =</span> array_weight)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Array Weight"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Sample-Level Quality Weights (arrayWeights)"</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/array-weights-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Array weights per sample. Values below 1 indicate downweighted (noisier) samples; values above 1 indicate upweighted (cleaner) samples.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>aw <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n       =</span> <span class="fu">n</span>(),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min     =</span> <span class="fu">min</span>(array_weight),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">q25     =</span> <span class="fu">quantile</span>(array_weight, <span class="fl">0.25</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median  =</span> <span class="fu">median</span>(array_weight),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">q75     =</span> <span class="fu">quantile</span>(array_weight, <span class="fl">0.75</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max     =</span> <span class="fu">max</span>(array_weight),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean    =</span> <span class="fu">mean</span>(array_weight),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd      =</span> <span class="fu">sd</span>(array_weight)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">"Distribution of array weights across all samples"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Distribution of array weights across all samples</caption>
<thead>
<tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">q25</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">q75</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">1.165</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">3.344</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.806</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="duplicatecorrelation-paired-design-modeling" class="level2">
<h2 class="anchored" data-anchor-id="duplicatecorrelation-paired-design-modeling">3.2 — duplicateCorrelation: Paired-Design Modeling</h2>
<p>Cancer survivor participants contributed two biopsies each (T1 and T2), creating a paired design. Measurements from the same individual are correlated—if a subject has generally higher protein abundances at T1, they tend to have generally higher abundances at T2 as well. Ignoring this correlation inflates the residual variance and reduces power, because the model attributes within-subject consistency to random error rather than to the paired structure.</p>
<p>The duplicateCorrelation function estimates a consensus within-subject correlation across all proteins. This single parameter captures the average degree to which repeated measurements on the same subject co-vary. The estimated correlation is then incorporated into the linear model via generalized least squares, properly accounting for the non-independence of paired observations.</p>
<p>This is particularly important for the Training_CR and Supplement_Interaction contrasts, both of which compare T1 and T2 measurements within the same subjects. Without duplicateCorrelation, the effective sample size for these within-subject contrasts would be underestimated, and the test would be conservative. The Cancer_vs_Healthy contrast, which compares independent groups, benefits less directly but still gains from the improved overall variance estimation.</p>
<p>The consensus correlation estimated by the pipeline reflects the proportion of total variance attributable to between-subject differences versus within-subject (residual) variation. A high correlation indicates that subjects differ substantially from each other but are internally consistent across timepoints, which is favorable for paired analyses.</p>
</section>
<section id="ebayesrobust-true-outlier-robust-hyperparameters" class="level2">
<h2 class="anchored" data-anchor-id="ebayesrobust-true-outlier-robust-hyperparameters">3.3 — eBayes(robust = TRUE): Outlier-Robust Hyperparameters</h2>
<p>Standard empirical Bayes moderation (Smyth, 2004) assumes that all proteins share a common prior variance distribution. The moderated t-statistic borrows strength across proteins by shrinking each protein’s variance toward this shared prior. However, a subset of proteins with unusually high or low variance—hypervariable proteins—can distort the prior estimate, pulling it away from the majority and degrading the shrinkage for well-behaved proteins.</p>
<p>The robust option in eBayes (Phipson et al., 2016) addresses this by using a robust estimator for the hyperparameters of the prior distribution. Specifically, it downweights proteins whose observed variance is far from the fitted prior, preventing a few outliers from corrupting the shrinkage applied to the majority. This is especially relevant in proteomics, where blood contamination proteins (hemoglobins, serum albumin) or highly variable structural proteins can exhibit variances orders of magnitude larger than typical proteins.</p>
<p>The robust approach does not remove hypervariable proteins from the analysis; rather, it limits their influence on the shared prior while still testing them individually. This is preferable to manual exclusion because it is data-driven, does not require arbitrary filtering decisions, and preserves the full protein list for downstream analyses.</p>
</section>
<section id="how-the-three-methods-complement-each-other" class="level2">
<h2 class="anchored" data-anchor-id="how-the-three-methods-complement-each-other">3.4 — How the Three Methods Complement Each Other</h2>
<p>The three robustness mechanisms operate at different levels of the analysis and are therefore complementary rather than redundant. arrayWeights operates at the sample level, adjusting for the fact that some samples are noisier than others. duplicateCorrelation operates at the design level, capturing the paired structure among observations from the same subject. eBayes(robust = TRUE) operates at the protein level, preventing hypervariable proteins from distorting the empirical Bayes shrinkage applied to all proteins.</p>
<p>Together, these three layers produce a model that is resilient to the common sources of heterogeneity in clinical proteomics: uneven sample quality, non-independent observations from repeated measures, and extreme variance outliers among the tested proteins. This is not a conservative approach—it is a calibrated one. By properly modeling each source of variation, the effective degrees of freedom and variance estimates are more accurate, which translates to both better type I error control and improved power to detect genuine biological differences.</p>
</section>
</section>
<section id="results-training_cr" class="level1">
<h1>4 — Results: Training_CR</h1>
<p>The Training_CR contrast tests whether 12 weeks of progressive resistance training alters the skeletal muscle proteome in cancer survivors. Because this contrast averages across supplement groups, it pools all CR participants and tests the within-subject change from T1 (baseline) to T2 (post-training). The paired design—each subject serving as their own control—removes between-subject variability and focuses on within-subject adaptation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tcr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"per_contrast_results"</span>, <span class="st">"Training_CR.csv"</span>),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tcr <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(adj.P.Val) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene, protein, logFC, P.Value, adj.P.Val, pi_score) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(logFC, pi_score), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>)),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">P.Value   =</span> <span class="fu">formatC</span>(P.Value, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">adj.P.Val =</span> <span class="fu">formatC</span>(adj.P.Val, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Training_CR: Top 20 proteins ranked by adjusted p-value"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Training_CR: Top 20 proteins ranked by adjusted p-value</caption>
<thead>
<tr class="header">
<th style="text-align: left;">gene</th>
<th style="text-align: left;">protein</th>
<th style="text-align: right;">logFC</th>
<th style="text-align: left;">P.Value</th>
<th style="text-align: left;">adj.P.Val</th>
<th style="text-align: right;">pi_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FTL</td>
<td style="text-align: left;">FRIL_HUMAN</td>
<td style="text-align: right;">2.541</td>
<td style="text-align: left;">6.84e-09</td>
<td style="text-align: left;">1.25e-05</td>
<td style="text-align: right;">20.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">THY1</td>
<td style="text-align: left;">THY1_HUMAN</td>
<td style="text-align: right;">1.520</td>
<td style="text-align: left;">1.02e-06</td>
<td style="text-align: left;">9.29e-04</td>
<td style="text-align: right;">9.108</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PFDN1</td>
<td style="text-align: left;">PFD1_HUMAN</td>
<td style="text-align: right;">-0.840</td>
<td style="text-align: left;">6.91e-06</td>
<td style="text-align: left;">4.21e-03</td>
<td style="text-align: right;">4.337</td>
</tr>
<tr class="even">
<td style="text-align: left;">RPL4</td>
<td style="text-align: left;">RL4_HUMAN</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: left;">3.15e-05</td>
<td style="text-align: left;">1.44e-02</td>
<td style="text-align: right;">2.133</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ARCN1</td>
<td style="text-align: left;">COPD_HUMAN</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: left;">5.98e-05</td>
<td style="text-align: left;">2.19e-02</td>
<td style="text-align: right;">1.857</td>
</tr>
<tr class="even">
<td style="text-align: left;">S100A13</td>
<td style="text-align: left;">S10AD_HUMAN</td>
<td style="text-align: right;">0.856</td>
<td style="text-align: left;">1.59e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">3.250</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPN</td>
<td style="text-align: left;">ASPN_HUMAN</td>
<td style="text-align: right;">1.312</td>
<td style="text-align: left;">2.35e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">4.763</td>
</tr>
<tr class="even">
<td style="text-align: left;">TMX4</td>
<td style="text-align: left;">TMX4_HUMAN</td>
<td style="text-align: right;">-0.541</td>
<td style="text-align: left;">1.78e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">2.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RAB12</td>
<td style="text-align: left;">RAB12_HUMAN</td>
<td style="text-align: right;">-0.398</td>
<td style="text-align: left;">2.45e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">1.438</td>
</tr>
<tr class="even">
<td style="text-align: left;">RAB5B</td>
<td style="text-align: left;">RAB5B_HUMAN</td>
<td style="text-align: right;">-0.532</td>
<td style="text-align: left;">2.41e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">1.926</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSNAX</td>
<td style="text-align: left;">TSNAX_HUMAN</td>
<td style="text-align: right;">-0.516</td>
<td style="text-align: left;">1.71e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">1.944</td>
</tr>
<tr class="even">
<td style="text-align: left;">GAA</td>
<td style="text-align: left;">LYAG_HUMAN</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: left;">1.75e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">1.888</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SORD</td>
<td style="text-align: left;">DHSO_HUMAN</td>
<td style="text-align: right;">-0.705</td>
<td style="text-align: left;">2.39e-04</td>
<td style="text-align: left;">3.45e-02</td>
<td style="text-align: right;">2.552</td>
</tr>
<tr class="even">
<td style="text-align: left;">FSCN1</td>
<td style="text-align: left;">FSCN1_HUMAN</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: left;">2.89e-04</td>
<td style="text-align: left;">3.78e-02</td>
<td style="text-align: right;">2.868</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LACTB2</td>
<td style="text-align: left;">LACB2_HUMAN</td>
<td style="text-align: right;">-0.469</td>
<td style="text-align: left;">4.11e-04</td>
<td style="text-align: left;">5.01e-02</td>
<td style="text-align: right;">1.587</td>
</tr>
<tr class="even">
<td style="text-align: left;">IQGAP1</td>
<td style="text-align: left;">IQGA1_HUMAN</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: left;">4.89e-04</td>
<td style="text-align: left;">5.12e-02</td>
<td style="text-align: right;">2.183</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DAG1</td>
<td style="text-align: left;">DAG1_HUMAN</td>
<td style="text-align: right;">-0.608</td>
<td style="text-align: left;">4.67e-04</td>
<td style="text-align: left;">5.12e-02</td>
<td style="text-align: right;">2.026</td>
</tr>
<tr class="even">
<td style="text-align: left;">JUP</td>
<td style="text-align: left;">PLAK_HUMAN</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: left;">5.03e-04</td>
<td style="text-align: left;">5.12e-02</td>
<td style="text-align: right;">2.341</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GLO1</td>
<td style="text-align: left;">LGUL_HUMAN</td>
<td style="text-align: right;">-0.388</td>
<td style="text-align: left;">6.59e-04</td>
<td style="text-align: left;">5.40e-02</td>
<td style="text-align: right;">1.234</td>
</tr>
<tr class="even">
<td style="text-align: left;">FTH1</td>
<td style="text-align: left;">FRIH_HUMAN</td>
<td style="text-align: right;">0.684</td>
<td style="text-align: left;">6.41e-04</td>
<td style="text-align: left;">5.40e-02</td>
<td style="text-align: right;">2.185</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The number of differentially expressed proteins at FDR &lt; 0.05 reflects the modest statistical power available for within-subject contrasts when the sample size per group is relatively small. Resistance training induces well-characterized adaptations in skeletal muscle—including shifts in contractile protein isoforms, mitochondrial biogenesis markers, and extracellular matrix remodeling—but detecting these at the proteome level requires sufficient replication to distinguish biological signal from measurement noise.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tcr, <span class="fu">aes</span>(<span class="at">x =</span> P.Value)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Nominal P-value"</span>, <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Training_CR --- P-value Distribution"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/training-cr-hist-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>P-value distribution for the Training_CR contrast. A spike near zero indicates genuine signal; a uniform distribution suggests no systematic effect.</figcaption>
</figure>
</div>
</div>
</div>
<p>The p-value histogram provides a diagnostic beyond the simple DEP count. A well-calibrated test under a mixture of null and alternative hypotheses produces a histogram with a uniform component (the null proteins) and an enrichment near zero (the true positives). The height and sharpness of the near-zero peak indicates the strength and prevalence of the training effect across the proteome.</p>
<p>Proteins that shift with training in cancer survivors may include contractile apparatus components (myosin heavy chains, troponins), metabolic enzymes involved in oxidative phosphorylation and glycolysis, and structural proteins of the extracellular matrix. The direction of change is informative: upregulation of mitochondrial and contractile proteins would suggest successful adaptation, while persistent downregulation might indicate incomplete recovery from cancer-related deconditioning.</p>
<p>The volcano plot below visualizes the relationship between effect size (log2 fold change, x-axis) and statistical significance (-log10 p-value, y-axis) for the Training_CR contrast. Each dot represents one protein. Proteins in the upper-left and upper-right corners show both large fold changes and high statistical significance. Red dots are significantly upregulated after training; blue dots are significantly downregulated. Gene names are shown for proteins reaching FDR &lt; 0.05.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tcr_volc <span class="ot">&lt;-</span> tcr <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Up"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Down"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NS"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sig_counts <span class="ot">&lt;-</span> tcr_volc <span class="sc">%&gt;%</span> <span class="fu">count</span>(sig)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>up_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Up"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>down_n <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Down"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ns_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"NS"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>volc_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Up"</span> <span class="ot">=</span> <span class="st">"#B2182B"</span>, <span class="st">"Down"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>, <span class="st">"NS"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>volc_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Up"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Up ("</span>, up_n, <span class="st">")"</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Down"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Down ("</span>, down_n, <span class="st">")"</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NS"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"NS ("</span>, ns_n, <span class="st">")"</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tcr_volc, <span class="fu">aes</span>(<span class="at">x =</span> logFC, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">color =</span> sig)) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tcr_volc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> gene),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">max.overlaps =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> volc_colors, <span class="at">labels =</span> volc_labels) <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"log2 Fold Change"</span>, <span class="at">y =</span> <span class="st">"-log10(P-value)"</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Training_CR --- Volcano Plot"</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Significance"</span>) <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/training-cr-volcano-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Volcano plot for the Training_CR contrast. Red = significantly upregulated (FDR &lt; 0.05, logFC &gt; 0); Blue = significantly downregulated (FDR &lt; 0.05, logFC &lt; 0); Gray = not significant.</figcaption>
</figure>
</div>
</div>
</div>
<p>Even when few proteins cross the FDR &lt; 0.05 threshold, the directional trends and top-ranked proteins are informative. The pi-score (described in Section 7) provides an alternative ranking that integrates fold change and significance, which can be particularly useful for generating hypotheses when formal significance is limited by sample size.</p>
</section>
<section id="results-cancer_vs_healthy" class="level1">
<h1>5 — Results: Cancer_vs_Healthy</h1>
<p>The Cancer_vs_Healthy contrast compares the baseline skeletal muscle proteome of cancer survivors with that of healthy age-matched controls. This comparison captures the cumulative effects of cancer, prior treatment, and associated physical deconditioning on the muscle proteome. Because it contrasts two independent groups (CR at T1 versus PPS at T1), it does not benefit from the paired design and relies instead on the between-group sample sizes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cvh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"per_contrast_results"</span>, <span class="st">"Cancer_vs_Healthy.csv"</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>cvh <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(adj.P.Val) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene, protein, logFC, P.Value, adj.P.Val, pi_score) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(logFC, pi_score), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>)),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">P.Value   =</span> <span class="fu">formatC</span>(P.Value, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">adj.P.Val =</span> <span class="fu">formatC</span>(adj.P.Val, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Cancer_vs_Healthy: Top 20 proteins ranked by adjusted p-value"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Cancer_vs_Healthy: Top 20 proteins ranked by adjusted p-value</caption>
<thead>
<tr class="header">
<th style="text-align: left;">gene</th>
<th style="text-align: left;">protein</th>
<th style="text-align: right;">logFC</th>
<th style="text-align: left;">P.Value</th>
<th style="text-align: left;">adj.P.Val</th>
<th style="text-align: right;">pi_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CFH</td>
<td style="text-align: left;">CFAH_HUMAN</td>
<td style="text-align: right;">3.044</td>
<td style="text-align: left;">1.06e-10</td>
<td style="text-align: left;">1.94e-07</td>
<td style="text-align: right;">30.360</td>
</tr>
<tr class="even">
<td style="text-align: left;">IGKV3-20</td>
<td style="text-align: left;">KV320_HUMAN</td>
<td style="text-align: right;">3.459</td>
<td style="text-align: left;">1.05e-09</td>
<td style="text-align: left;">3.94e-07</td>
<td style="text-align: right;">31.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CLU</td>
<td style="text-align: left;">CLUS_HUMAN</td>
<td style="text-align: right;">2.861</td>
<td style="text-align: left;">1.10e-09</td>
<td style="text-align: left;">3.94e-07</td>
<td style="text-align: right;">25.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">IGKV3-11</td>
<td style="text-align: left;">KV311_HUMAN</td>
<td style="text-align: right;">2.769</td>
<td style="text-align: left;">9.38e-10</td>
<td style="text-align: left;">3.94e-07</td>
<td style="text-align: right;">24.999</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SERPING1</td>
<td style="text-align: left;">IC1_HUMAN</td>
<td style="text-align: right;">2.886</td>
<td style="text-align: left;">1.29e-09</td>
<td style="text-align: left;">3.94e-07</td>
<td style="text-align: right;">25.655</td>
</tr>
<tr class="even">
<td style="text-align: left;">SNCA</td>
<td style="text-align: left;">SYUA_HUMAN</td>
<td style="text-align: right;">3.680</td>
<td style="text-align: left;">1.14e-09</td>
<td style="text-align: left;">3.94e-07</td>
<td style="text-align: right;">32.910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C3</td>
<td style="text-align: left;">CO3_HUMAN</td>
<td style="text-align: right;">3.036</td>
<td style="text-align: left;">2.28e-09</td>
<td style="text-align: left;">4.62e-07</td>
<td style="text-align: right;">26.242</td>
</tr>
<tr class="even">
<td style="text-align: left;">ITIH4</td>
<td style="text-align: left;">ITIH4_HUMAN</td>
<td style="text-align: right;">3.107</td>
<td style="text-align: left;">2.00e-09</td>
<td style="text-align: left;">4.62e-07</td>
<td style="text-align: right;">27.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PNP</td>
<td style="text-align: left;">PNPH_HUMAN</td>
<td style="text-align: right;">2.618</td>
<td style="text-align: left;">2.03e-09</td>
<td style="text-align: left;">4.62e-07</td>
<td style="text-align: right;">22.759</td>
</tr>
<tr class="even">
<td style="text-align: left;">CP</td>
<td style="text-align: left;">CERU_HUMAN</td>
<td style="text-align: right;">2.673</td>
<td style="text-align: left;">3.47e-09</td>
<td style="text-align: left;">5.91e-07</td>
<td style="text-align: right;">22.614</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SERPINA3</td>
<td style="text-align: left;">AACT_HUMAN</td>
<td style="text-align: right;">2.566</td>
<td style="text-align: left;">3.56e-09</td>
<td style="text-align: left;">5.91e-07</td>
<td style="text-align: right;">21.684</td>
</tr>
<tr class="even">
<td style="text-align: left;">IGKV3-15</td>
<td style="text-align: left;">KV315_HUMAN</td>
<td style="text-align: right;">3.181</td>
<td style="text-align: left;">4.10e-09</td>
<td style="text-align: left;">6.25e-07</td>
<td style="text-align: right;">26.676</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IGHV3-7</td>
<td style="text-align: left;">HV307_HUMAN</td>
<td style="text-align: right;">3.092</td>
<td style="text-align: left;">7.38e-09</td>
<td style="text-align: left;">9.64e-07</td>
<td style="text-align: right;">25.147</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGT</td>
<td style="text-align: left;">ANGT_HUMAN</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: left;">7.27e-09</td>
<td style="text-align: left;">9.64e-07</td>
<td style="text-align: right;">18.877</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IGKC</td>
<td style="text-align: left;">IGKC_HUMAN</td>
<td style="text-align: right;">2.913</td>
<td style="text-align: left;">9.35e-09</td>
<td style="text-align: left;">1.14e-06</td>
<td style="text-align: right;">23.390</td>
</tr>
<tr class="even">
<td style="text-align: left;">CAT</td>
<td style="text-align: left;">CATA_HUMAN</td>
<td style="text-align: right;">2.528</td>
<td style="text-align: left;">1.14e-08</td>
<td style="text-align: left;">1.30e-06</td>
<td style="text-align: right;">20.081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A2M</td>
<td style="text-align: left;">A2MG_HUMAN</td>
<td style="text-align: right;">3.016</td>
<td style="text-align: left;">1.49e-08</td>
<td style="text-align: left;">1.58e-06</td>
<td style="text-align: right;">23.608</td>
</tr>
<tr class="even">
<td style="text-align: left;">CFB</td>
<td style="text-align: left;">CFAB_HUMAN</td>
<td style="text-align: right;">2.508</td>
<td style="text-align: left;">1.55e-08</td>
<td style="text-align: left;">1.58e-06</td>
<td style="text-align: right;">19.586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IGLC2</td>
<td style="text-align: left;">IGLC2_HUMAN</td>
<td style="text-align: right;">2.909</td>
<td style="text-align: left;">2.33e-08</td>
<td style="text-align: left;">2.14e-06</td>
<td style="text-align: right;">22.202</td>
</tr>
<tr class="even">
<td style="text-align: left;">FARSB</td>
<td style="text-align: left;">SYFB_HUMAN</td>
<td style="text-align: right;">-0.803</td>
<td style="text-align: left;">2.34e-08</td>
<td style="text-align: left;">2.14e-06</td>
<td style="text-align: right;">6.131</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This contrast is expected to yield the largest number of differentially expressed proteins among the three comparisons. The biological distance between cancer survivors and healthy controls encompasses not only the direct effects of malignancy but also the downstream consequences of treatment (chemotherapy-induced muscle wasting, corticosteroid exposure, prolonged inactivity) and the systemic inflammatory state that persists in many survivors. These are profound perturbations that leave measurable imprints on the muscle proteome.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cvh, <span class="fu">aes</span>(<span class="at">x =</span> P.Value)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Nominal P-value"</span>, <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Cancer_vs_Healthy --- P-value Distribution"</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/cvh-hist-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>P-value distribution for the Cancer_vs_Healthy contrast.</figcaption>
</figure>
</div>
</div>
</div>
<p>The p-value histogram for this contrast should show a pronounced spike near zero, reflecting the abundance of truly differentially expressed proteins. A strong leftward skew confirms that the biological signal overwhelms the null distribution and that the multiple testing correction retains a substantial number of discoveries at FDR &lt; 0.05.</p>
<p>Biologically, proteins elevated in cancer survivors relative to healthy controls may include acute-phase reactants, stress-response proteins, and markers of proteolytic pathway activation (ubiquitin-proteasome, autophagy). Proteins depleted in cancer survivors may include mitochondrial enzymes, contractile machinery components, and metabolic enzymes associated with healthy muscle function. The pattern of up-and-down regulation can reveal which pathways are activated versus suppressed in the cancer survivor muscle, providing a molecular fingerprint of cancer-related muscle dysfunction.</p>
<p>The volcano plot below shows the magnitude and significance of proteomic differences between cancer survivors and healthy controls at baseline. Proteins in the upper corners represent the strongest candidates for cancer-associated muscle dysfunction. Red dots indicate proteins elevated in cancer survivors relative to healthy controls; blue dots indicate proteins depleted in cancer survivors.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cvh_volc <span class="ot">&lt;-</span> cvh <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Up"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Down"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NS"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>sig_counts <span class="ot">&lt;-</span> cvh_volc <span class="sc">%&gt;%</span> <span class="fu">count</span>(sig)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>up_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Up"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>down_n <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Down"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ns_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"NS"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>volc_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Up"</span> <span class="ot">=</span> <span class="st">"#B2182B"</span>, <span class="st">"Down"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>, <span class="st">"NS"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>volc_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Up"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Up ("</span>, up_n, <span class="st">")"</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Down"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Down ("</span>, down_n, <span class="st">")"</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NS"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"NS ("</span>, ns_n, <span class="st">")"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cvh_volc, <span class="fu">aes</span>(<span class="at">x =</span> logFC, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">color =</span> sig)) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> cvh_volc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> gene),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">max.overlaps =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> volc_colors, <span class="at">labels =</span> volc_labels) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"log2 Fold Change"</span>, <span class="at">y =</span> <span class="st">"-log10(P-value)"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Cancer_vs_Healthy --- Volcano Plot"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Significance"</span>) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/cvh-volcano-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Volcano plot for the Cancer_vs_Healthy contrast. Red = significantly upregulated in cancer survivors (FDR &lt; 0.05, logFC &gt; 0); Blue = significantly downregulated (FDR &lt; 0.05, logFC &lt; 0); Gray = not significant.</figcaption>
</figure>
</div>
</div>
</div>
<p>Interpreting this contrast requires caution about confounding. Differences between CR and PPS groups may reflect not only cancer and treatment effects but also unmeasured lifestyle, dietary, or genetic differences between the groups. The study design mitigates this through age matching, but residual confounding cannot be excluded in an observational comparison. The results should therefore be interpreted as associative rather than causal.</p>
</section>
<section id="results-supplement_interaction" class="level1">
<h1>6 — Results: Supplement_Interaction</h1>
<p>The Supplement_Interaction contrast tests whether creatine supplementation modifies the training-induced proteome response differently than placebo. As an interaction contrast, it compares the within-subject change (T2 minus T1) in the CRE arm against the within-subject change in the PLA arm. A significant result would indicate that the proteome-level training adaptation depends on supplement group assignment.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>supp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"per_contrast_results"</span>, <span class="st">"Supplement_Interaction.csv"</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>supp <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(adj.P.Val) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene, protein, logFC, P.Value, adj.P.Val, pi_score) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(logFC, pi_score), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>)),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">P.Value   =</span> <span class="fu">formatC</span>(P.Value, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">adj.P.Val =</span> <span class="fu">formatC</span>(adj.P.Val, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Supplement_Interaction: Top 20 proteins ranked by adjusted p-value"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Supplement_Interaction: Top 20 proteins ranked by adjusted p-value</caption>
<thead>
<tr class="header">
<th style="text-align: left;">gene</th>
<th style="text-align: left;">protein</th>
<th style="text-align: right;">logFC</th>
<th style="text-align: left;">P.Value</th>
<th style="text-align: left;">adj.P.Val</th>
<th style="text-align: right;">pi_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HNRNPDL</td>
<td style="text-align: left;">HNRDL_HUMAN</td>
<td style="text-align: right;">1.134</td>
<td style="text-align: left;">2.78e-05</td>
<td style="text-align: left;">5.09e-02</td>
<td style="text-align: right;">5.167</td>
</tr>
<tr class="even">
<td style="text-align: left;">C11orf68</td>
<td style="text-align: left;">CK068_HUMAN</td>
<td style="text-align: right;">-1.299</td>
<td style="text-align: left;">7.99e-05</td>
<td style="text-align: left;">7.31e-02</td>
<td style="text-align: right;">5.323</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PFDN1</td>
<td style="text-align: left;">PFD1_HUMAN</td>
<td style="text-align: right;">1.257</td>
<td style="text-align: left;">3.39e-04</td>
<td style="text-align: left;">1.69e-01</td>
<td style="text-align: right;">4.362</td>
</tr>
<tr class="even">
<td style="text-align: left;">ETHE1</td>
<td style="text-align: left;">ETHE1_HUMAN</td>
<td style="text-align: right;">-1.189</td>
<td style="text-align: left;">5.54e-04</td>
<td style="text-align: left;">1.69e-01</td>
<td style="text-align: right;">3.871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LHPP</td>
<td style="text-align: left;">LHPP_HUMAN</td>
<td style="text-align: right;">-2.148</td>
<td style="text-align: left;">5.22e-04</td>
<td style="text-align: left;">1.69e-01</td>
<td style="text-align: right;">7.052</td>
</tr>
<tr class="even">
<td style="text-align: left;">UBE2F</td>
<td style="text-align: left;">UBE2F_HUMAN</td>
<td style="text-align: right;">-1.584</td>
<td style="text-align: left;">5.26e-04</td>
<td style="text-align: left;">1.69e-01</td>
<td style="text-align: right;">5.193</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIMM8A</td>
<td style="text-align: left;">TIM8A_HUMAN</td>
<td style="text-align: right;">-1.835</td>
<td style="text-align: left;">8.00e-04</td>
<td style="text-align: left;">2.09e-01</td>
<td style="text-align: right;">5.683</td>
</tr>
<tr class="even">
<td style="text-align: left;">RPL23A</td>
<td style="text-align: left;">RL23A_HUMAN</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: left;">1.20e-03</td>
<td style="text-align: left;">2.71e-01</td>
<td style="text-align: right;">2.213</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RBMX</td>
<td style="text-align: left;">RBMX_HUMAN</td>
<td style="text-align: right;">1.460</td>
<td style="text-align: left;">1.33e-03</td>
<td style="text-align: left;">2.71e-01</td>
<td style="text-align: right;">4.197</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDR39U1</td>
<td style="text-align: left;">D39U1_HUMAN</td>
<td style="text-align: right;">-2.037</td>
<td style="text-align: left;">1.63e-03</td>
<td style="text-align: left;">2.98e-01</td>
<td style="text-align: right;">5.680</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VARS1</td>
<td style="text-align: left;">SYVC_HUMAN</td>
<td style="text-align: right;">0.719</td>
<td style="text-align: left;">1.97e-03</td>
<td style="text-align: left;">3.01e-01</td>
<td style="text-align: right;">1.943</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSFM</td>
<td style="text-align: left;">EFTS_HUMAN</td>
<td style="text-align: right;">-1.309</td>
<td style="text-align: left;">1.95e-03</td>
<td style="text-align: left;">3.01e-01</td>
<td style="text-align: right;">3.547</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GOSR2</td>
<td style="text-align: left;">GOSR2_HUMAN</td>
<td style="text-align: right;">-1.769</td>
<td style="text-align: left;">2.61e-03</td>
<td style="text-align: left;">3.18e-01</td>
<td style="text-align: right;">4.570</td>
</tr>
<tr class="even">
<td style="text-align: left;">SIRT3</td>
<td style="text-align: left;">SIR3_HUMAN</td>
<td style="text-align: right;">-1.253</td>
<td style="text-align: left;">2.43e-03</td>
<td style="text-align: left;">3.18e-01</td>
<td style="text-align: right;">3.276</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TMX4</td>
<td style="text-align: left;">TMX4_HUMAN</td>
<td style="text-align: right;">0.850</td>
<td style="text-align: left;">2.30e-03</td>
<td style="text-align: left;">3.18e-01</td>
<td style="text-align: right;">2.243</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIMM44</td>
<td style="text-align: left;">TIM44_HUMAN</td>
<td style="text-align: right;">-1.243</td>
<td style="text-align: left;">3.23e-03</td>
<td style="text-align: left;">3.69e-01</td>
<td style="text-align: right;">3.097</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HNRNPD</td>
<td style="text-align: left;">HNRPD_HUMAN</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: left;">3.79e-03</td>
<td style="text-align: left;">4.08e-01</td>
<td style="text-align: right;">1.417</td>
</tr>
<tr class="even">
<td style="text-align: left;">PARVA</td>
<td style="text-align: left;">PARVA_HUMAN</td>
<td style="text-align: right;">-0.903</td>
<td style="text-align: left;">4.18e-03</td>
<td style="text-align: left;">4.25e-01</td>
<td style="text-align: right;">2.148</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HNRNPA3</td>
<td style="text-align: left;">ROA3_HUMAN</td>
<td style="text-align: right;">1.657</td>
<td style="text-align: left;">5.88e-03</td>
<td style="text-align: left;">5.38e-01</td>
<td style="text-align: right;">3.696</td>
</tr>
<tr class="even">
<td style="text-align: left;">RBBP4</td>
<td style="text-align: left;">RBBP4_HUMAN</td>
<td style="text-align: right;">-0.917</td>
<td style="text-align: left;">5.84e-03</td>
<td style="text-align: left;">5.38e-01</td>
<td style="text-align: right;">2.048</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This contrast is the most statistically demanding of the three. Testing an interaction requires detecting a difference of differences, which effectively halves the signal relative to a main-effect contrast. With approximately 8 subjects per supplement group, power to detect moderate interaction effects is limited. The absence of significant findings at FDR &lt; 0.05 does not necessarily mean that creatine has no effect on the training response—it may simply mean that the study was underpowered to detect such effects at the proteome level.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(supp, <span class="fu">aes</span>(<span class="at">x =</span> P.Value)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Nominal P-value"</span>, <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supplement_Interaction --- P-value Distribution"</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/supp-hist-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>P-value distribution for the Supplement_Interaction contrast. A uniform distribution indicates no systematic signal.</figcaption>
</figure>
</div>
</div>
</div>
<p>The p-value histogram is the most informative diagnostic for underpowered contrasts. A uniform distribution across the 0-to-1 range confirms that there is no systematic departure from the null hypothesis: the observed p-values are consistent with what would be expected if all proteins were truly null. This pattern—a flat histogram—is a hallmark of a well-calibrated test applied to data with no signal, rather than an indication of analytical failure.</p>
<p>Distinguishing a true biological null from an underpowered analysis requires external information. Creatine supplementation during resistance training has shown mixed results in the broader literature, with some studies reporting benefits in lean mass accretion and strength gains but fewer demonstrating proteome-level effects. The present sample size of approximately 8 per group is near the lower bound of what is detectable for proteomics interaction effects, so the null result should be interpreted conservatively.</p>
<p>The volcano plot below displays the interaction effect — whether creatine supplementation modifies the training-induced proteome response differently than placebo. With the limited sample size for this interaction contrast, few or no proteins may reach formal significance (FDR &lt; 0.05), but the overall shape of the volcano reveals whether there are any trends toward differential supplement effects.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>supp_volc <span class="ot">&lt;-</span> supp <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Up"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> logFC <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Down"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NS"</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>sig_counts <span class="ot">&lt;-</span> supp_volc <span class="sc">%&gt;%</span> <span class="fu">count</span>(sig)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>up_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Up"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>down_n <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"Down"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>ns_n   <span class="ot">&lt;-</span> sig_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">"NS"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span> { <span class="cf">if</span> (<span class="fu">length</span>(.) <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span>L <span class="cf">else</span> . }</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>volc_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Up"</span> <span class="ot">=</span> <span class="st">"#B2182B"</span>, <span class="st">"Down"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>, <span class="st">"NS"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>volc_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Up"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Up ("</span>, up_n, <span class="st">")"</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Down"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Down ("</span>, down_n, <span class="st">")"</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NS"</span>   <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"NS ("</span>, ns_n, <span class="st">")"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(supp_volc, <span class="fu">aes</span>(<span class="at">x =</span> logFC, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">color =</span> sig)) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> supp_volc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> gene),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">max.overlaps =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> volc_colors, <span class="at">labels =</span> volc_labels) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"log2 Fold Change"</span>, <span class="at">y =</span> <span class="st">"-log10(P-value)"</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supplement_Interaction --- Volcano Plot"</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Significance"</span>) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CvH_DEP_files/figure-html/supp-volcano-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Volcano plot for the Supplement_Interaction contrast. Red = significantly upregulated (FDR &lt; 0.05, logFC &gt; 0); Blue = significantly downregulated (FDR &lt; 0.05, logFC &lt; 0); Gray = not significant.</figcaption>
</figure>
</div>
</div>
</div>
<p>For underpowered contrasts where formal FDR control yields no discoveries, the pi-score provides an alternative ranking that integrates both effect size and statistical evidence. Proteins with high pi-scores—those with large fold changes and low p-values, even if neither alone reaches a strict threshold—represent the most promising candidates for follow-up in larger studies. The pi-score approach is discussed in detail in Section 7.</p>
</section>
<section id="multi-criteria-significance" class="level1">
<h1>7 — Multi-Criteria Significance</h1>
<p>Proteomics experiments with limited sample sizes benefit from a multi-criteria significance framework that goes beyond a single FDR threshold. Different thresholds serve different scientific purposes, and the appropriate choice depends on the goal of the analysis: publication- ready claims require strict control, while hypothesis generation for follow-up studies can tolerate more liberal criteria.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"DA_summary.csv"</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>da <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Differential abundance summary across contrasts and significance criteria"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Differential abundance summary across contrasts and significance criteria</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">sig.PVal</th>
<th style="text-align: right;">sig.FDR</th>
<th style="text-align: right;">pval_thresh</th>
<th style="text-align: right;">lfc_thresh</th>
<th style="text-align: left;">p_adj_method</th>
<th style="text-align: right;">sig.Pi</th>
<th style="text-align: right;">sig.Nominal.01</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Training_CR</td>
<td style="text-align: left;">down</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">Training_CR</td>
<td style="text-align: left;">nonsig</td>
<td style="text-align: right;">1544</td>
<td style="text-align: right;">1815</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">1738</td>
<td style="text-align: right;">1731</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Training_CR</td>
<td style="text-align: left;">up</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cancer_vs_Healthy</td>
<td style="text-align: left;">down</td>
<td style="text-align: right;">333</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">216</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cancer_vs_Healthy</td>
<td style="text-align: left;">nonsig</td>
<td style="text-align: right;">1080</td>
<td style="text-align: right;">1247</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">1738</td>
<td style="text-align: right;">1298</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cancer_vs_Healthy</td>
<td style="text-align: left;">up</td>
<td style="text-align: right;">416</td>
<td style="text-align: right;">337</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">315</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Supplement_Interaction</td>
<td style="text-align: left;">down</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Supplement_Interaction</td>
<td style="text-align: left;">nonsig</td>
<td style="text-align: right;">1729</td>
<td style="text-align: right;">1829</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">1738</td>
<td style="text-align: right;">1800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Supplement_Interaction</td>
<td style="text-align: left;">up</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BH</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>FDR &lt; 0.05</strong> is the gold standard for publication-ready differential expression claims. The Benjamini-Hochberg procedure controls the expected proportion of false discoveries among all proteins declared significant. At this threshold, no more than 5% of the reported hits are expected to be false positives on average. This is the appropriate criterion for making confident biological claims and for prioritizing proteins for expensive validation experiments (e.g., Western blot, targeted MS).</p>
<p><strong>FDR &lt; 0.10</strong> is an exploratory threshold acceptable for hypothesis generation. It relaxes the false discovery control slightly, allowing more proteins through at the cost of a modestly higher false positive rate. This threshold is useful for pathway-level analyses where the goal is to identify enriched biological processes rather than to make claims about individual proteins. The logic is that pathway enrichment analysis aggregates information across many proteins, so individual false positives are less damaging when the analytical unit shifts from proteins to pathways.</p>
<p><strong>Nominal p &lt; 0.01</strong> bypasses multiple testing correction entirely and is appropriate only when combined with effect-size thresholds or when the goal is exploratory ranking. For underpowered contrasts such as the Supplement_Interaction, applying strict FDR control may yield zero discoveries even when biologically meaningful trends exist. The nominal threshold, combined with fold-change filtering, can identify proteins worthy of follow-up while clearly acknowledging the increased risk of false positives. Results reported at this threshold should be framed as hypothesis-generating rather than confirmatory.</p>
<p><strong>Pi-score</strong> (Xiao et al., 2014) provides an unbiased ranking that integrates statistical significance and biological significance (effect size) into a single metric. The pi-score is defined as <span class="math inline">\(-\log_{10}(p) \times |\text{logFC}|\)</span>, which gives high scores to proteins that are both statistically significant and biologically meaningful. This is particularly valuable for underpowered contrasts where neither p-value nor fold change alone provides a reliable ranking: a protein with a modest p-value and a large fold change may be more biologically interesting than one with a slightly lower p-value but negligible effect size.</p>
<p>The pi-score ranks are converted to empirical p-values by ranking the scores and dividing by the total number of proteins tested. The top 5% by pi-score (pi_pval &lt; 0.05) represent proteins with the strongest combined evidence of statistical and biological significance. This approach is especially useful for the Supplement_Interaction contrast, where no proteins reach FDR &lt; 0.05 but the top pi-score candidates may still point to biologically coherent pathways.</p>
<p>The summary table above reports counts under each criterion for all three contrasts, stratified by direction (up, down, nonsignificant). The Cancer_vs_Healthy contrast dominates in terms of discovery count at every threshold, consistent with its expected biological strength. The Training_CR contrast yields moderate discoveries, and the Supplement_Interaction contrast yields few or none under stringent criteria. This pattern is consistent with the expected effect sizes and the available statistical power for each comparison.</p>
<p>Across all criteria, it is essential to interpret the counts in the context of the total number of proteins tested. A discovery count of 14 out of 1,829 tested proteins at FDR &lt; 0.05 carries different biological weight than 14 out of 100. The per-contrast results tables (Sections 4–6) provide the individual protein identities behind these counts, enabling biological interpretation beyond summary statistics.</p>
</section>
<section id="conclusion" class="level1">
<h1>8 — Conclusion</h1>
<p>The differential expression analysis of the CvH proteomics dataset reveals a graded pattern of signal strength across the three study contrasts. The Cancer_vs_Healthy comparison yields the strongest and most abundant differential expression, consistent with the profound biological distance between cancer survivors and healthy controls. The Training_CR contrast identifies a more modest set of proteins that respond to 12 weeks of resistance training, reflecting the within-subject paired design and the averaging across supplement groups. The Supplement_Interaction contrast yields no discoveries at FDR &lt; 0.05, consistent with either a true absence of creatine-specific proteome effects or insufficient power to detect them with the available sample size.</p>
<p>The three-layer robustness approach—arrayWeights, duplicateCorrelation, and robust eBayes—provides a model that is well-calibrated for the specific challenges of this clinical proteomics dataset. Sample quality weighting avoids the information loss of outlier removal, paired-design modeling captures the within-subject correlation structure, and robust hyperparameter estimation protects against the influence of hypervariable proteins. Together, these mechanisms maximize the extractable signal while maintaining rigorous type I error control.</p>
<p>The multi-criteria significance framework accommodates the different power profiles of the three contrasts. For Cancer_vs_Healthy, strict FDR control is appropriate and productive. For Training_CR, a combination of FDR &lt; 0.05 and exploratory FDR &lt; 0.10 thresholds provides a tiered view of the training response. For Supplement_Interaction, pi-score ranking and nominal p-value thresholds are the most informative tools for identifying candidate proteins worthy of further investigation.</p>
<p>These results establish the foundation for downstream analyses, including pathway enrichment, network analysis, and integration with clinical outcome data. The per-contrast results files and the combined results table provide the inputs needed for these subsequent analyses.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li><p>Ritchie ME, Phipson B, Wu D, et al.&nbsp;(2015). limma powers differential expression analyses for RNA-sequencing and microarray studies. <em>Nucleic Acids Research</em> 43(7):e47.</p></li>
<li><p>Phipson B, Lee S, Oshlack A, et al.&nbsp;(2016). Robust hyperparameter estimation protects against hypervariable genes and improves power to detect differential expression. <em>Annals of Applied Statistics</em> 10(2):946-963.</p></li>
<li><p>Zhu Y, Orre LM, Johansson HJ, et al.&nbsp;(2020). DEqMS: a method for accurate variance estimation in differential protein expression analysis. <em>Molecular &amp; Cellular Proteomics</em> 19(6):1047-1057.</p></li>
<li><p>Ritchie ME, Diyagama D, Neilson J, et al.&nbsp;(2006). Empirical array quality weights in the analysis of microarray data. <em>BMC Bioinformatics</em> 7:261.</p></li>
<li><p>Smyth GK (2004). Linear models and empirical Bayes methods for assessing differential expression in microarray experiments. <em>Statistical Applications in Genetics and Molecular Biology</em> 3(1):Article 3.</p></li>
<li><p>Xiao Y, Hsiao TH, Suez U, et al.&nbsp;(2014). A novel significance score for gene selection and ranking. <em>Bioinformatics</em> 30(6):801-807.</p></li>
<li><p>Liu R, Holik AZ, Su S, et al.&nbsp;(2015). Why weight? Modelling sample and observational level variability improves power in RNA-seq analyses. <em>Nucleic Acids Research</em> 43(15):e97.</p></li>
<li><p>Valikangas T, Suomi T, Elo LL (2018). A systematic evaluation of normalization methods in quantitative label-free proteomics. <em>Briefings in Bioinformatics</em> 19(1):1-11.</p></li>
</ol>
</section>
<section id="session-info" class="level1">
<h1>Session Info</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13)
Platform: aarch64-apple-darwin20
Running under: macOS Tahoe 26.2

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] here_1.0.2      ggrepel_0.9.6   patchwork_1.3.2 ggplot2_4.0.2  
[5] knitr_1.51      tidyr_1.3.2     dplyr_1.2.0     readr_2.1.6    

loaded via a namespace (and not attached):
 [1] bit_4.6.0          gtable_0.3.6       jsonlite_2.0.0     crayon_1.5.3      
 [5] compiler_4.5.1     Rcpp_1.1.1         tidyselect_1.2.1   parallel_4.5.1    
 [9] scales_1.4.0       yaml_2.3.12        fastmap_1.2.0      R6_2.6.1          
[13] labeling_0.4.3     generics_0.1.4     htmlwidgets_1.6.4  tibble_3.3.1      
[17] rprojroot_2.1.1    pillar_1.11.1      RColorBrewer_1.1-3 tzdb_0.5.0        
[21] rlang_1.1.7        xfun_0.56          S7_0.2.1           bit64_4.6.0-1     
[25] otel_0.2.0         cli_3.6.5          withr_3.0.2        magrittr_2.0.4    
[29] digest_0.6.39      grid_4.5.1         vroom_1.7.0        hms_1.1.4         
[33] lifecycle_1.0.5    vctrs_0.7.1        evaluate_1.0.5     glue_1.8.0        
[37] farver_2.1.2       pacman_0.5.1       rmarkdown_2.30     purrr_1.2.1       
[41] tools_4.5.1        pkgconfig_2.0.3    htmltools_0.5.9   </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>